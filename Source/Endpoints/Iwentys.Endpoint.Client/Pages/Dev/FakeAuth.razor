@page "/dev/fakeauth"

@using Blazored.LocalStorage
@using Iwentys.Endpoint.Client.Tools

@inject HttpClient Http
@inject IAuthService AuthService
@inject ILocalStorageService LocalStorage

<MatTextField Value="@Token" Label="Token"></MatTextField>
<MatTextField @bind-Value="@UserId" Label="UserId"></MatTextField>
<MatButton @onclick="@Update">Update</MatButton>

@code {

    public int UserId { get; set; } = 1;
    public string Token { get; set; }

    protected override async Task OnInitializedAsync()
    {
        var savedToken = await LocalStorage.GetItemAsync<string>("authToken");
        Token = string.IsNullOrEmpty(savedToken) ? "no token" : savedToken;
    }

    private async Task Update()
    {
        await AuthService.Login(UserId);
    }
}